/* Copyright (C) 2007 - 2011 YOOtheme GmbH, YOOtheme Proprietary Use License (http://www.yootheme.com/license) */

(function(a){var d=function(){};d.prototype=a.extend(d.prototype,{name:"ImportExport",options:{msgImportWarning:"Please choose a file first!"},initialize:function(b,c){this.options=a.extend({},this.options,c);var e=this;b.find("div.uploadbox").each(function(){var f=a(this).find("input.filename");a(this).find('input[name^="import-"]').bind("change",function(){f.val(this.value)});a(this).find("button.upload").bind("click",function(){f.val()==""?alert(e.options.msgImportWarning):submitbutton("import")})});
b.find("a.exporter-link").each(function(){var f=a(this);f.bind("click",function(){b.find('input[name="exporter"]').val(f.attr("id"));submitbutton("importfrom")})});b.find("button.export").bind("click",function(){var f=b.find('input[name="format"]');f.val("raw");b.find('input[name="exporter"]').val("zoo2");submitbutton("doexport");f.val("html")})}});a.fn[d.prototype.name]=function(){var b=arguments,c=b[0]?b[0]:null;return this.each(function(){var e=a(this);if(d.prototype[c]&&e.data(d.prototype.name)&&
c!="initialize")e.data(d.prototype.name)[c].apply(e.data(d.prototype.name),Array.prototype.slice.call(b,1));else if(!c||a.isPlainObject(c)){var f=new d;d.prototype.initialize&&f.initialize.apply(f,a.merge([e],b));e.data(d.prototype.name,f)}else a.error("Method "+c+" does not exist on jQuery."+d.name)})}})(jQuery);
(function(a){var d=function(){};d.prototype=a.extend(d.prototype,{name:"Import",options:{msgSelectWarning:"You didn't assign all item types. Items of these types will not be imported. Do you want to proceed anyway?",msgWarningDuplicate:"There are duplicate assignments.",msgNameWarning:"Please choose a name column.",task:"doimport"},initialize:function(b,c){this.options=a.extend({},this.options,c);var e=this;this.form=b;b.find("fieldset.frontpage, fieldset.categories").each(function(){var f=a(this);
f.find('input[name^="import-"]').bind("change",function(){a(this).is(":checked")?f.find("div.assign-group").show():f.find("div.assign-group").hide()})});b.find("fieldset.items").each(function(){var f=a(this);f.find("select.type").bind("change",function(){var g=a(this),h=RegExp("\\["+g.val()+"\\]$");f.find("li.assign select.assign").each(function(){a(this).attr("name").match(h)?a(this).show():a(this).hide()})})});a("#submit-button").bind("click",function(){if(e.options.task!="doimportcsv"&&e.hasDuplicateSelectedAssignments())alert(e.options.msgWarningDuplicate);
else if(e.options.task=="doimportcsv"&&!e.hasNameAssigned())alert(e.options.msgNameWarning);else e.hasUnassignedTypes()&&!confirm(e.options.msgSelectWarning)||submitbutton(e.options.task)})},hasNameAssigned:function(){var b=false;this.form.find("div.assign-group").each(function(){var c=RegExp("\\["+a(this).find("select.type").val()+"\\]$");a(this).find("select.assign").each(function(){if(a(this).attr("name").match(c)&&a(this).val()=="_name")b=true})});return b},hasUnassignedTypes:function(){var b=
false;this.form.find("select.type").each(function(){if(a(this).val()=="")b=true});return b},hasDuplicateSelectedAssignments:function(){var b=false;this.form.find("div.assign-group").each(function(){var c=a(this).find("select.assign");for(i=0;i<c.length;i++)for(j=i+1;j<c.length;j++){value_a=a(c.get(i)).val();value_b=a(c.get(j)).val();if(value_a!=""&&value_a!="_category"&&value_a==value_b){b=true;return}}});return b}});a.fn[d.prototype.name]=function(){var b=arguments,c=b[0]?b[0]:null;return this.each(function(){var e=
a(this);if(d.prototype[c]&&e.data(d.prototype.name)&&c!="initialize")e.data(d.prototype.name)[c].apply(e.data(d.prototype.name),Array.prototype.slice.call(b,1));else if(!c||a.isPlainObject(c)){var f=new d;d.prototype.initialize&&f.initialize.apply(f,a.merge([e],b));e.data(d.prototype.name,f)}else a.error("Method "+c+" does not exist on jQuery."+d.name)})}})(jQuery);
