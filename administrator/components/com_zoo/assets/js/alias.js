/* Copyright (C) 2007 - 2010 YOOtheme GmbH, YOOtheme Proprietary Use License (http://www.yootheme.com/license) */

Zoo.AliasEdit=new Class({Implements:[Options],initialize:function(b){this.setOptions({edit:false,edit_field_name:"alias"},b);var a=this;this.name_edit=$("name-edit");this.trigger=this.name_edit.getElement("a.trigger");this.panel=this.name_edit.getElement("div.panel");this.text=this.name_edit.getElement('input[name="'+this.options.edit_field_name+'"]');this.name=this.name_edit.getElement('input[name="name"]');this.options.edit||this.name.addEvent("blur",function(){var c=Zoo.String.slugify(this.get("value"));
if(c!=""){a.text.value=c;a.trigger.set("text",c);this.removeEvents()}});this.trigger.addEvent("click",function(){this.setStyle("display","none");a.panel.addClass("active");a.text.focus();a.text.addEvent("keydown",function(c){c=new Event(c);c.key=="enter"&&a.setAlias();c.key=="esc"&&a.remove()});a.name_edit.getElement("input.accept").addEvent("click",function(){a.setAlias()});a.name_edit.getElement("a.cancel").addEvent("click",function(){a.remove()})})},setAlias:function(){var b=Zoo.String.slugify(this.text.get("value"));
if(b=="")b=(b=Zoo.String.slugify(this.name.get("value")))?b:"42";this.text.value=b;this.trigger.set("text",b);this.remove()},remove:function(){this.trigger.removeProperty("style");this.panel.removeClass("active")}});
