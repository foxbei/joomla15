/* Copyright (C) 2007 - 2010 YOOtheme GmbH, YOOtheme Proprietary Use License (http://www.yootheme.com/license) */

Zoo.BrowseItems=new Class({Implements:[Options],initialize:function(d){this.setOptions({url:"index.php"},d);this.timer=null;this.delay=1500;$$("#items-default td.priority").each(function(a){var b=a.getElement("input.value");b.addEvent("change",this.save.bind(this));a.getElement("span.plus").addEvent("click",function(){b.set("value",b.get("value").toInt()+1).fireEvent("change")});a.getElement("span.minus").addEvent("click",function(){b.set("value",b.get("value").toInt()-1).fireEvent("change")})}.bind(this))},
save:function(){$clear(this.timer);this.timer=function(){var d=new Hash,a=$("items-default").getElement("table.list");$("items-default").getElements("input[name^=priority], input[type=hidden]").each(function(b){var c=b.name,e=b.get("value");e===false||!c||b.disabled||d.set(c,e)});(new Request.JSON({url:this.options.url,data:(new Hash({task:"savepriority",format:"raw"})).combine(d),onRequest:function(){a.addClass("loader")},onComplete:function(b,c){a.removeClass("loader");Message.show(c,true)}})).post()}.bind(this).delay(this.delay)}});
Zoo.EditItem=new Class({initialize:function(){var d=this;["apply","save"].each(function(a){$("toolbar-"+a).getElement("a").removeProperty("onclick").addEvent("click",function(){d.submit(a)})});$("categories").addEvent("change",function(){var a=this.getSelected().map(function(c){return c.get("value")}),b=$("paramsprimary_category").get("value");if(!a.contains(b))$("paramsprimary_category").value=a.length?a.shift():""});$("paramsprimary_category").addEvent("change",function(){var a=$("categories").getSelected().map(function(c){return c.get("value")}),
b=this.get("value");if(b&&!a.contains(b)){a.push(b);$("categories").getChildren().each(function(c){a.contains(c.get("value"))&&c.setProperty("selected","selected")})}})},submit:function(d){$("name-edit").getElement('input[name="name"]').get("value")==""?$("name-edit").getElement("span.message-name").setStyle("display","inline"):submitbutton(d)}});
