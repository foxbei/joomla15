/* Copyright (C) 2007 - 2010 YOOtheme GmbH, YOOtheme Proprietary Use License (http://www.yootheme.com/license) */

window.relateditems={};function selectRelateditem(b,c,d){document.getElementById("sbox-window").close();window.relateditems[d].addItem(b,c)}
var ElementRelateditems=new Class({Implements:[Options],initialize:function(b,c){this.setOptions({variable:null,msgDeleteItem:"Delete Item",msgSortItem:"Sort Item"},c);var d=this;this.list=$(b).getElement("ul");this.list.getElements("li").each(function(a){a.getElement("div.item-delete").addEvent("click",function(){d.deleteItem(a)})});this.sort=new Sortables(this.list,{handle:"div.sort",clone:true,opacity:0.5,revert:true,constrain:true,onStart:function(a,e){a.addClass("dragging");e.addClass("ghost");
e.setStyles({"z-index":99})},onComplete:function(a){a.removeClass("dragging")}});this.displayList()},addItem:function(b,c){var d=false;this.list.getElements("li input").each(function(e){if(e.getProperty("value")==b)d=true});if(!d){var a=new Element("li");a.set("html",'<div class="item-name">'+c+'</div><div class="item-sort" title="'+this.options.msgSortItem+'"></div><div class="item-delete" title="'+this.options.msgDeleteItem+'"></div><input type="hidden" name="'+this.options.variable+'" value="'+
b+'"/>');a.injectInside(this.list).getElement("div.item-delete").addEvent("click",function(){this.deleteItem(a)}.bind(this));this.sort.addItems(a)}this.displayList()},deleteItem:function(b){var c=this;this.sort&&this.sort.removeItems(b);(new Fx.Morph(b,{duration:100,transition:Fx.Transitions.linear})).start({height:0,opacity:0}).chain(function(){b.dispose();c.displayList()})},displayList:function(){this.list.getFirst()?this.list.setStyle("display",null):this.list.setStyle("display","none")}});
